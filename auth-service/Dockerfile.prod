FROM node:12.16.3

ARG NODE_ENV
ARG AUTH_SERVICE_DB_PORT
ARG AUTH_SERVICE_DB_HOST
ARG AUTH_SERVICE_DB_NAME
ARG AUTH_SERVICE_PORT
ARG REDIS_PORT
ARG REDIS_HOST
ARG JWT_SECRET
ARG REFRESH_SECRET

WORKDIR /usr/src/app
COPY package.json yarn.lock ./
RUN yarn
RUN yarn build

ENTRYPOINT [ "yarn", "start:prod" ]